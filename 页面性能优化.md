## **开发之前关于页面性能的规划**

## **如何查找页面加载过慢的原因**

首先了解chrome开发工具的network面板，最好通过[**官方文档**](https://developers.google.com/web/tools/chrome-devtools/)进行了解。(浏览器需要翻墙才可以访问)

### **了解 Resource Timing**

#### 进入resource timing的两种方式：

1. 将鼠标悬停到 Timeline 列下的耗时图表上。这将呈现一个显示完整耗时数据的弹出窗口。

   ![images text](https://github.com/shaniawei/resource/blob/master/images/time2.png)


2. 点击任何条目并打开该条目的 Timing 标签。

   ![images text](https://github.com/shaniawei/resource/blob/master/images/time.png)

[了解resource timing具体的字段意思及相关性能问题的解决方式](https://developers.google.com/web/tools/chrome-devtools/network-performance/understanding-resource-timing)



> ***主要关注点：***

- queueing --chrome http 1.x处理最大请求并发数为6 超过这一部分的请求需要等前6个请求有一半返回后才开始发送

  ![images text](https://github.com/shaniawei/resource/blob/master/images/4.png)

- waiting  --发送请求成功至客户端收到服务器返回的第一个字节

  ![images text](https://github.com/shaniawei/resource/blob/master/images/5.png)

- download/loading  --接收数据所需时间

  ![images text](https://github.com/shaniawei/resource/blob/master/images/6.png)

> ***对应的解决方式：***

- 进行[域分片](https://blog.stackpath.com/glossary/domain-sharding/)或者部署http2
- 排除网络差的原因，优化后台数据库查询等(本地看下是不是网络的原因)
- 将资源进行对应的压缩

### **此处疑问：**

1.域分片是什么意思？具体如何操作？

2.http 1.x与http2的联系与区别

## **页面性能优化的方式**

**减少HTTP请求**

1.图片

- ​	图片地图的方式

  ​		*区域定位必须准确*

```HTML
<img src="planets.jpg" border="0" usemap="#planetmap" alt="Planets" />
<map name="planetmap" id="planetmap">
  <area shape="circle" coords="180,139,14" href ="venus.html" alt="Venus" />
  <area shape="circle" coords="129,161,10" href ="mercur.html" alt="Mercury" />
  <area shape="rect" coords="0,0,110,260" href ="sun.html" alt="Sun" />
</map>
```

- ​	css sprites

  ​	*将小图标合并成大图标*

  ​	优点：1.减少图片字节

  ​		    2.减少http请求

  ​	缺点：1.对每个图标的定位必须准确

  ​		    2.  如需新增其他图标只能在尾部增加

  - 转换成图片based



- ​	字体图标

2.css js

​	可以合并的 css  js文件尽量合并

​	文件大小小于2kb的直接内联在script/style标签中

**精简css js代码**

​	删除无用的js css代码

​	注重代码的复用，灵活运用浏览器的缓存机制，将复用的css js文件缓存下来，加快加载速度

**js文件放在底部**

​	浏览器解析html文档是从上往下执行的。页面渲染完成前，如果在head中引入js文件会阻塞浏览器对body中的dom解析，导致页面延迟显示。

​	css文件放在head中，避免文档空白或者无样式页面的闪烁。

**使用内容分发网络CDN**

​	*优缺点以及实现机制*

**添加Expires**

**配置ETag**

**使Ajax可缓存**

**避免重定向**

**减少DNS查找**

**压缩打包整个项目**

**SSL/TLS协商的时间 https请求记得优化TLS**

**tcp链接在同意域名下保持长连接**



## **如何查找页面运行速度过慢的原因**



首先了解performance面板，之前叫时间线面板

要想运行速度加快，尽量避免重绘和重排。







开始渲染时间是用户首次从空白页面到看到页面加载出东西的时间

开始渲染时间一般不超过1.5s 超过这个时间就得优化



1.移动端最好使用小于100kb大小的图片
2.pc端最好使用小于200kb大小的图片
3.页面运行时的性能表现监测 链接：https://zhuanlan.zhihu.com/p/29879682
4.使用chrome开发工具的waterfall 查看页面加载的具体情况 根据不同的指标进行页面的优化
链接：https://www.cnblogs.com/shengulong/p/7449927.html
https://www.zhihu.com/question/27085552/answer/35194131

5.性能分析工具：http://www.mmtrix.com/evaluate/applist#



- 使用 [PageSpeed Insights](https://developers.google.com/speed/pagespeed/insights) 确定可以应用到您网站的性能最佳做法，以及使用 [PageSpeed 优化工具](https://developers.google.com/speed/pagespeed/optimization)将应用这些最佳做法的流程自动化。

- [Google Chrome 中的高性能网络](https://www.igvita.com/posa/high-performance-networking-in-google-chrome/)讨论了 Chrome 网络内部机制，以及您如何充分利用它们让您的网站更快。

- [gzip 压缩的工作原理](https://developers.google.com/speed/articles/gzip)提供了 gzip 压缩的高级概览，并介绍了这种压缩为什么是一种不错的方法。

- [网页性能最佳做法](https://developers.google.com/speed/docs/best-practices/rules_intro)提供了更多用于优化您的网页或应用的网络性能的提示。

  ​

问题：

图片大小较大，加载时间较长，在不增加http请求+不放在cdn的情况下，如何压缩图片体积   加快加载速度？

1.文字区域尽量使用html代码编辑



